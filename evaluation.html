<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>F# Formatting: Output embedding
</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Tomas Petricek; Oleg Pestov; Anh-Dung Phan; Xiang Zhang; Matthias Dittrich">

  <!--
    <link rel="icon" type="image/png" sizes="32x32" href="https://fsprojects.github.io/FSharp.Formatting/static/images/favicon.png"/>


    <link rel="stylesheet" href="https://fsprojects.github.io/FSharp.Formatting/static/css/nucleus.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/js/fontawesome.min.js"/>
    <link rel="stylesheet" href="https://fsprojects.github.io/FSharp.Formatting/static/css/hybrid.css"/>
    <link rel="stylesheet" href="https://fsprojects.github.io/FSharp.Formatting/static/css/featherlight.min.css"/>
    <link rel="stylesheet" href="https://fsprojects.github.io/FSharp.Formatting/static/css/perfect-scrollbar.min.css"/>
  -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css"/>
  <!--

    <link rel="stylesheet" href="https://fsprojects.github.io/FSharp.Formatting/static/css/atom-one-dark-reasonable.css"/>
    <link rel="stylesheet" href="https://fsprojects.github.io/FSharp.Formatting/static/css/theme.css"/>
    <link rel="stylesheet" href="https://fsprojects.github.io/FSharp.Formatting/static/css/theme-green.css"/>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/perfect-scrollbar@1.5.0/dist/perfect-scrollbar.common.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.perfect-scrollbar/1.5.0/perfect-scrollbar.min.js"></script>
    <script src="https://fsharp.github.io/fsharp-core-api-docs//static/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-js/1.3.0/sticky.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.13/featherlight.min.js"></script>
    <script src="https://fsharp.github.io/fsharp-core-api-docs//static/js/modernizr.custom-3.6.0.js"></script>
    <script type="text/javascript" src="https://fsprojects.github.io/FSharp.Formatting/content/learn.js"></script>
    <script src="https://fsharp.github.io/fsharp-core-api-docs//static/js/hugo-learn.js"></script> 
     <link rel="stylesheet" href="https://fsharp.github.io/fsharp-core-api-docs//static/mermaid/mermaid.css"/>
    <script src="https://fsharp.github.io/fsharp-core-api-docs//static/mermaid/mermaid.js"></script> 
    <script>
      mermaid.initialize({ startOnLoad: true });
    </script> 
  
  -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/styles/atom-one-dark.min.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/languages/fsharp.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>
  <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
  <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>


  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

  <link type="text/css" rel="stylesheet" href="https://fsprojects.github.io/FSharp.Formatting/content/style.css" />
  <script type="text/javascript" src="https://fsprojects.github.io/FSharp.Formatting/content/tips.js"></script>
  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>
  <div class="container">
    <div class="masthead">
      <ul class="nav nav-pills pull-right">
        <li><a href="http://fsharp.org">fsharp.org</a></li>
      </ul>
      <h3 class="muted"><a href="https://fsprojects.github.io/FSharp.Formatting/index.html">FSharp.Formatting</a></h3>
    </div>
    <hr />
    <div class="row">
      <div class="span9" id="main">
        <h1><a name="F-Formatting-Output-embedding" class="anchor" href="#F-Formatting-Output-embedding">F# Formatting: Output embedding</a></h1>
<p>A nice feature of the literate programming package (<code>FSharp.Formatting.Literate.dll</code> in F# Formatting)
is that it lets you embed the result of running the script as part of the literate output.
This is a feature of the functions discussed in <a href="literate.html">literate programming</a> and
it is implemented using the <a href="http://fsharp.github.io/FSharp.Compiler.Service/">F# Compiler service</a>.</p>
<h2><a name="Embedding-literate-script-output" class="anchor" href="#Embedding-literate-script-output">Embedding literate script output</a></h2>
<p>The functionality is currently available (and tested) for F# script files (<code>*.fsx</code>) that
contain special comments to embed the Markdown text. To embed output of a script file,
a couple of additional special comments are added.</p>
<p>The following snippet (F# Script file) demonstates the functionality:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">(** </span>
<span class="c">### Evaluation demo </span>
<span class="c">The following is a simple calculation: *)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">test</span> <span class="o">=</span> <span class="n">40</span> <span class="o">+</span> <span class="n">2</span>

<span class="c">(** We can print it as follows: *)</span>
<span class="c">(*** define-output:test ***)</span>
<span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="fn">printf</span> <span class="s">&quot;Result is: </span><span class="pf">%d</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs1', 3)" onmouseover="showTip(event, 'fs1', 3)" class="id">test</span>

<span class="c">(** The result of the previous snippet is: *)</span>
<span class="c">(*** include-output:test ***)</span>

<span class="c">(** And the variable `test` has the following value: *)</span>
<span class="c">(*** include-value: test ***)</span>
</code></pre></td>
</tr>
</table>
<p>The script defines a variable <code>test</code> and then prints it. The comment <code>(*** define-output:test ***)</code>
is used to capture the result of the printing (using the key <code>test</code>) so that it can be embedded
later in the script. We refer to it using another special comment written as <code>(*** include-output:test ***)</code>.
In addition, it is also possible to include the value of any variable using the comment
<code>(*** include-value: test ***)</code>. By default, this is formatted using the <code>"%A"</code> formatter in F# (but
the next section shows how to override this behavior). The formatted result of the above snippet looks
as follows:</p>
<blockquote>
<h3>Evaluation demo</h3>
<p>The following is a simple calculation:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span class="i">test</span> <span class="o">=</span> <span class="n">40</span> <span class="o">+</span> <span class="n">2</span></pre>
</td>
</tr>
</table>
<p>We can print it as follows:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">printf</span> <span class="s">&quot;</span><span class="s">Result</span><span class="s"> </span><span class="s">is</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">d</span><span class="s">&quot;</span> <span class="i">test</span></pre>
</td>
</tr>
</table>
<p>The result of the previous snippet is:</p>
<table class="pre"><tr><td><pre><code>Result is: 42
</code></pre></td></tr></table>
<p>And the variable <code>test</code> has the following value:</p>
<table class="pre"><tr><td><pre><code>42
</code></pre></td></tr></table></blockquote>
<p>In addition to the commands demonstrated in the above sample, you can also use
the following variations to include the output and <code>it</code> values produced by a snippet.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">(*** include-it: test ***)</span>
<span class="c">(*** include-output: test ***)</span>
</code></pre></td>
</tr>
</table>
<p>If no snippet is named
the immediately preceeding previous snippet is used.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="fn">printfn</span> <span class="s">&quot;hello world&quot;</span>
<span class="c">(*** include-output ***)</span>

<span class="n">200</span><span class="o">+</span><span class="n">300</span>
<span class="c">(*** include-it ***)</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Specifying-the-evaluator-and-formatting" class="anchor" href="#Specifying-the-evaluator-and-formatting">Specifying the evaluator and formatting</a></h2>
<p>The embedding of F# output requires specifying an additional parameter to the
parsing functions discussed in <a href="literate.html">literate programming documentation</a>.
Assuming you have all the references in place, you can now create an instance of
<code>FsiEvaluator</code> that represents a wrapper for F# interactive and pass it to all the
functions that parse script files or process script files:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="id">Formatting</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="id">Literate</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs4', 8)" onmouseover="showTip(event, 'fs4', 8)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs5', 9)" onmouseover="showTip(event, 'fs5', 9)" class="id">Formatting</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs6', 10)" onmouseover="showTip(event, 'fs6', 10)" class="id">Literate</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs7', 11)" onmouseover="showTip(event, 'fs7', 11)" class="id">Evaluation</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs4', 12)" onmouseover="showTip(event, 'fs4', 12)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs5', 13)" onmouseover="showTip(event, 'fs5', 13)" class="id">Formatting</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs8', 14)" onmouseover="showTip(event, 'fs8', 14)" class="id">Markdown</span>

<span class="c">// Sample literate content</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 15)" onmouseover="showTip(event, 'fs9', 15)" class="id">content</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">let a = 10</span>
<span class="s">(*** include-value:a ***)&quot;&quot;&quot;</span>

<span class="c">// Create evaluator and parse script</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 16)" onmouseover="showTip(event, 'fs10', 16)" class="id">fsi</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs11', 17)" onmouseover="showTip(event, 'fs11', 17)" class="rt">FsiEvaluator</span><span class="pn">(</span><span class="pn">)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 18)" onmouseover="showTip(event, 'fs12', 18)" class="id">doc</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 19)" onmouseover="showTip(event, 'fs13', 19)" class="rt">Literate</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 20)" onmouseover="showTip(event, 'fs14', 20)" class="id">ParseScriptString</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs9', 21)" onmouseover="showTip(event, 'fs9', 21)" class="id">content</span><span class="pn">,</span> <span class="id">fsiEvaluator</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 22)" onmouseover="showTip(event, 'fs10', 22)" class="id">fsi</span><span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs13', 23)" onmouseover="showTip(event, 'fs13', 23)" class="rt">Literate</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs15', 24)" onmouseover="showTip(event, 'fs15', 24)" class="id">ToHtml</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs12', 25)" onmouseover="showTip(event, 'fs12', 25)" class="id">doc</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>When the <code>fsiEvaluator</code> parameter is specified, the script is evaluated and so you
can use additional commands such as <code>include-value</code>. When the evaluator is <em>not</em> specified,
it is not created automatically and so the functionality is not available (this way,
you won't accidentally run unexpected code!)</p>
<p>If you specify the <code>fsiEvaluator</code> parameter, but don't want a specific snippet to be evaluated
(because it might throw an exception, for example), you can use the <code>(*** do-not-eval ***)</code>
command.</p>
<p>The constructor of <code>FsiEvaluator</code> takes command line parameters for <code>fsi.exe</code> that can
be used to specify, for example, defined symbols and other attributes for F# Interactive.</p>
<p>You can also subscribe to the <code>EvaluationFailed</code> event which is fired whenever the evaluation
of an expression fails. You can use that to do tests that verify that all off the code in your
documentation executes without errors.</p>
<h2><a name="Emitting-Raw-Text" class="anchor" href="#Emitting-Raw-Text">Emitting Raw Text</a></h2>
<p>When writing documents, it is sometimes required to emit completely unaltered text. Up to this point all
of the <code>commands</code> have decorated the code or text with some formatting, for example a <code>pre</code> element. When working
with layout or content generation engines such as Jeykll, we sometimes need to emit plain text as declarations to
said engines. This is where the <code>raw</code> command is useful.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">(**</span>
<span class="c">	(*** raw ***)</span>
<span class="c">	Some raw text.</span>
<span class="c">*)</span>
</code></pre></td>
</tr>
</table>
<p>which would emit</p>
<pre>
Some raw text.
</pre>
<p>directly into the document.</p>
<h2><a name="Custom-formatting-functions" class="anchor" href="#Custom-formatting-functions">Custom formatting functions</a></h2>
<p>As mentioned earlier, values are formatted using a simple <code>"%A"</code> formatter by default.
However, you can specify a formatting function that provides a nicer formatting for values
of certain types. For example, let's say that we would want to format F# lists such as
<code>[1; 2; 3]</code> as HTML ordered lists <code>&lt;ol&gt;</code>.</p>
<p>This can be done by calling <code>RegisterTransformation</code> on the <code>FsiEvaluator</code> instance:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Create evaluator &amp; register simple formatter for lists</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs16', 26)" onmouseover="showTip(event, 'fs16', 26)" class="id">fsiOl</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs11', 27)" onmouseover="showTip(event, 'fs11', 27)" class="rt">FsiEvaluator</span><span class="pn">(</span><span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs16', 28)" onmouseover="showTip(event, 'fs16', 28)" class="fn">fsiOl</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs17', 29)" onmouseover="showTip(event, 'fs17', 29)" class="id">RegisterTransformation</span><span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs18', 30)" onmouseover="showTip(event, 'fs18', 30)" class="id">o</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs19', 31)" onmouseover="showTip(event, 'fs19', 31)" class="id">ty</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs20', 32)" onmouseover="showTip(event, 'fs20', 32)" class="id">_executionCount</span><span class="pn">)</span> <span class="k">-&gt;</span>
  <span class="c">// If the type of value is an F# list, format it nicely</span>
  <span class="k">if</span> <span onmouseout="hideTip(event, 'fs19', 33)" onmouseover="showTip(event, 'fs19', 33)" class="id">ty</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs21', 34)" onmouseover="showTip(event, 'fs21', 34)" class="id">IsGenericType</span> <span class="o">&amp;&amp;</span> <span onmouseout="hideTip(event, 'fs19', 35)" onmouseover="showTip(event, 'fs19', 35)" class="fn">ty</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs22', 36)" onmouseover="showTip(event, 'fs22', 36)" class="id">GetGenericTypeDefinition</span><span class="pn">(</span><span class="pn">)</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 37)" onmouseover="showTip(event, 'fs23', 37)" class="k">typedefof</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs24', 38)" onmouseover="showTip(event, 'fs24', 38)" class="rt">list</span><span class="pn">&lt;</span><span class="id">_</span><span class="pn">&gt;</span><span class="pn">&gt;</span> <span class="k">then</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 39)" onmouseover="showTip(event, 'fs25', 39)" class="id">items</span> <span class="o">=</span> 
      <span class="c">// Get items as objects and create paragraph for each item</span>
      <span class="pn">[</span> <span class="k">for</span> <span onmouseout="hideTip(event, 'fs26', 40)" onmouseover="showTip(event, 'fs26', 40)" class="id">it</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs27', 41)" onmouseover="showTip(event, 'fs27', 41)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs28', 42)" onmouseover="showTip(event, 'fs28', 42)" class="id">cast</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs29', 43)" onmouseover="showTip(event, 'fs29', 43)" class="rt">obj</span><span class="pn">&gt;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs30', 44)" onmouseover="showTip(event, 'fs30', 44)" class="fn">unbox</span> <span onmouseout="hideTip(event, 'fs18', 45)" onmouseover="showTip(event, 'fs18', 45)" class="id">o</span><span class="pn">)</span> <span class="k">-&gt;</span> 
          <span class="pn">[</span> <span onmouseout="hideTip(event, 'fs31', 46)" onmouseover="showTip(event, 'fs31', 46)" class="uc">Paragraph</span><span class="pn">(</span><span class="pn">[</span><span onmouseout="hideTip(event, 'fs32', 47)" onmouseover="showTip(event, 'fs32', 47)" class="uc">Literal</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs26', 48)" onmouseover="showTip(event, 'fs26', 48)" class="fn">it</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs33', 49)" onmouseover="showTip(event, 'fs33', 49)" class="id">ToString</span><span class="pn">(</span><span class="pn">)</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs34', 50)" onmouseover="showTip(event, 'fs34', 50)" class="uc">None</span><span class="pn">)</span><span class="pn">]</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs34', 51)" onmouseover="showTip(event, 'fs34', 51)" class="uc">None</span><span class="pn">)</span> <span class="pn">]</span> <span class="pn">]</span>
    <span class="c">// Return option value (success) with ordered list</span>
    <span onmouseout="hideTip(event, 'fs35', 52)" onmouseover="showTip(event, 'fs35', 52)" class="uc">Some</span> <span class="pn">[</span> <span onmouseout="hideTip(event, 'fs36', 53)" onmouseover="showTip(event, 'fs36', 53)" class="uc">ListBlock</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs37', 54)" onmouseover="showTip(event, 'fs37', 54)" class="rt">MarkdownListKind</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 55)" onmouseover="showTip(event, 'fs38', 55)" class="id">Ordered</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs25', 56)" onmouseover="showTip(event, 'fs25', 56)" class="id">items</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs34', 57)" onmouseover="showTip(event, 'fs34', 57)" class="uc">None</span><span class="pn">)</span> <span class="pn">]</span>
  <span class="k">else</span> <span onmouseout="hideTip(event, 'fs34', 58)" onmouseover="showTip(event, 'fs34', 58)" class="uc">None</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>The function is called with two arguments - <code>o</code> is the value to be formatted and <code>ty</code>
is the static type of the value (as inferred by the F# compiler). The sample checks
that the type of the value is a list (containing values of any type) and then it
casts all values in the list to <code>obj</code> (for simplicity). Then we generate Markdown
blocks representing an ordered list. This means that the code will work for both
LaTeX and HTML formatting - but if you only need one, you can simply produce HTML and
embed it in <code>InlineBlock</code>.</p>
<p>To use the new <code>FsiEvaluator</code>, we can use the same style as earlier. This time, we format
a simple list containing strings:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 59)" onmouseover="showTip(event, 'fs39', 59)" class="id">listy</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">### Formatting demo</span>
<span class="s">let test = [&quot;one&quot;;&quot;two&quot;;&quot;three&quot;]</span>
<span class="s">(*** include-value:test ***)&quot;&quot;&quot;</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs40', 60)" onmouseover="showTip(event, 'fs40', 60)" class="id">docOl</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 61)" onmouseover="showTip(event, 'fs13', 61)" class="rt">Literate</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 62)" onmouseover="showTip(event, 'fs14', 62)" class="id">ParseScriptString</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs39', 63)" onmouseover="showTip(event, 'fs39', 63)" class="id">listy</span><span class="pn">,</span> <span class="id">fsiEvaluator</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs16', 64)" onmouseover="showTip(event, 'fs16', 64)" class="id">fsiOl</span><span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs13', 65)" onmouseover="showTip(event, 'fs13', 65)" class="rt">Literate</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs15', 66)" onmouseover="showTip(event, 'fs15', 66)" class="id">ToHtml</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs40', 67)" onmouseover="showTip(event, 'fs40', 67)" class="id">docOl</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>The resulting HTML formatting of the document contains the snippet that defines <code>test</code>,
followed by a nicely formatted ordered list:</p>
<blockquote>
<h3>Formatting demo</h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <spanclass="i">test</span> <span class="o">=</span> [<span class="s">&quot;</span><span class="s">one</span><span class="s">&quot;</span>;<span class="s">&quot;</span><span class="s">two</span><span class="s">&quot;</span>;<span class="s">&quot;</span><span class="s">three</span><span class="s">&quot;</span>]</pre>
</td>
</tr>
</table>
<ol>
<li><p>one</p></li>
<li><p>two</p></li>
<li><p>three</p></li>
</ol>
</blockquote>

        <div class="tip" id="fs1">val test : int</div>
<div class="tip" id="fs2">val printf : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T</div>
<div class="tip" id="fs3">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T</div>
<div class="tip" id="fs4">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="tip" id="fs5">namespace FSharp.Formatting</div>
<div class="tip" id="fs6">namespace FSharp.Formatting.Literate</div>
<div class="tip" id="fs7">namespace FSharp.Formatting.Literate.Evaluation</div>
<div class="tip" id="fs8">namespace FSharp.Formatting.Markdown</div>
<div class="tip" id="fs9">val content : string</div>
<div class="tip" id="fs10">val fsi : FsiEvaluator</div>
<div class="tip" id="fs11">Multiple items<br />type FsiEvaluator =<br />&#160;&#160;interface IFsiEvaluator<br />&#160;&#160;new : ?options:string [] * ?fsiObj:obj -&gt; FsiEvaluator<br />&#160;&#160;member RegisterTransformation : f:(obj * Type * int -&gt; MarkdownParagraph list option) -&gt; unit<br />&#160;&#160;member EvaluationFailed : IEvent&lt;FsiEvaluationFailedInfo&gt;<br /><br />--------------------<br />new : ?options:string [] * ?fsiObj:obj -&gt; FsiEvaluator</div>
<div class="tip" id="fs12">val doc : LiterateDocument</div>
<div class="tip" id="fs13">type Literate =<br />&#160;&#160;private new : unit -&gt; Literate<br />&#160;&#160;static member ConvertDirectory : inputDirectory:string * ?htmlTemplate:string * ?outputDirectory:string * ?formatAgent:CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?fsiEvaluator:IFsiEvaluator * ?parameters:(string * string) list * ?includeSource:bool * ?generateAnchors:bool * ?recursive:bool * ?customizeDocument:(LiterateProcessingContext -&gt; LiterateDocument -&gt; LiterateDocument) * ?tokenKindToCss:(TokenKind -&gt; string) -&gt; unit<br />&#160;&#160;static member ConvertDocument : doc:LiterateDocument * output:string * ?template:string * ?outputKind:OutputKind * ?prefix:string * ?lineNumbers:bool * ?includeSource:bool * ?generateAnchors:bool * ?parameters:(string * string) list -&gt; unit<br />&#160;&#160;static member ConvertMarkdown : input:string * ?template:string * ?output:string * ?outputKind:OutputKind * ?formatAgent:CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?parameters:(string * string) list * ?includeSource:bool * ?generateAnchors:bool * ?customizeDocument:(LiterateProcessingContext -&gt; LiterateDocument -&gt; LiterateDocument) -&gt; unit<br />&#160;&#160;static member ConvertScriptFile : input:string * ?template:string * ?output:string * ?outputKind:OutputKind * ?formatAgent:CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?fsiEvaluator:IFsiEvaluator * ?parameters:(string * string) list * ?includeSource:bool * ?generateAnchors:bool * ?customizeDocument:(LiterateProcessingContext -&gt; LiterateDocument -&gt; LiterateDocument) -&gt; unit<br />&#160;&#160;static member FormatLiterateNodes : doc:LiterateDocument * ?outputKind:OutputKind * ?prefix:string * ?lineNumbers:bool * ?generateAnchors:bool * ?tokenKindToCss:(TokenKind -&gt; string) -&gt; LiterateDocument<br />&#160;&#160;static member private ParseAndTransformMarkdown : input:string * ?output:string * ?outputKind:OutputKind * ?formatAgent:CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?parameters:(string * string) list * ?includeSource:bool * ?generateAnchors:bool * ?customizeDocument:(LiterateProcessingContext -&gt; LiterateDocument -&gt; LiterateDocument) * ?tokenKindToCss:(TokenKind -&gt; string) -&gt; LiterateDocModel<br />&#160;&#160;static member private ParseAndTransformScriptFile : input:string * ?output:string * ?outputKind:OutputKind * ?formatAgent:CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?fsiEvaluator:IFsiEvaluator * ?parameters:(string * string) list * ?includeSource:bool * ?generateAnchors:bool * ?customizeDocument:(LiterateProcessingContext -&gt; LiterateDocument -&gt; LiterateDocument) * ?tokenKindToCss:(TokenKind -&gt; string) -&gt; LiterateDocModel<br />&#160;&#160;static member ParseMarkdownFile : path:string * ?formatAgent:CodeFormatAgent * ?compilerOptions:string * ?definedSymbols:string list * ?references:bool * ?fsiEvaluator:IFsiEvaluator * ?parseOptions:MarkdownParseOptions -&gt; LiterateDocument<br />&#160;&#160;static member ParseMarkdownString : content:string * ?path:string * ?formatAgent:CodeFormatAgent * ?compilerOptions:string * ?definedSymbols:string list * ?references:bool * ?fsiEvaluator:IFsiEvaluator * ?parseOptions:MarkdownParseOptions -&gt; LiterateDocument<br />&#160;&#160;...</div>
<div class="tip" id="fs14">static member Literate.ParseScriptString : content:string * ?path:string * ?formatAgent:FSharp.Formatting.CodeFormat.CodeFormatAgent * ?compilerOptions:string * ?definedSymbols:string list * ?references:bool * ?fsiEvaluator:IFsiEvaluator * ?parseOptions:MarkdownParseOptions -&gt; LiterateDocument</div>
<div class="tip" id="fs15">static member Literate.ToHtml : doc:LiterateDocument * ?prefix:string * ?lineNumbers:bool * ?generateAnchors:bool * ?tokenKindToCss:(FSharp.Formatting.CodeFormat.TokenKind -&gt; string) -&gt; string</div>
<div class="tip" id="fs16">val fsiOl : FsiEvaluator</div>
<div class="tip" id="fs17">member FsiEvaluator.RegisterTransformation : f:(obj * System.Type * int -&gt; MarkdownParagraph list option) -&gt; unit</div>
<div class="tip" id="fs18">val o : obj</div>
<div class="tip" id="fs19">val ty : System.Type</div>
<div class="tip" id="fs20">val _executionCount : int</div>
<div class="tip" id="fs21">property System.Type.IsGenericType: bool with get</div>
<div class="tip" id="fs22">System.Type.GetGenericTypeDefinition() : System.Type</div>
<div class="tip" id="fs23">val typedefof&lt;&#39;T&gt; : System.Type</div>
<div class="tip" id="fs24">type &#39;T list = List&lt;&#39;T&gt;</div>
<div class="tip" id="fs25">val items : MarkdownParagraph list list</div>
<div class="tip" id="fs26">val it : obj</div>
<div class="tip" id="fs27">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs28">val cast : source:System.Collections.IEnumerable -&gt; seq&lt;&#39;T&gt;</div>
<div class="tip" id="fs29">type obj = System.Object</div>
<div class="tip" id="fs30">val unbox : value:obj -&gt; &#39;T</div>
<div class="tip" id="fs31">union case MarkdownParagraph.Paragraph: body: MarkdownSpans * range: MarkdownRange option -&gt; MarkdownParagraph</div>
<div class="tip" id="fs32">Multiple items<br />union case MarkdownSpan.Literal: text: string * range: MarkdownRange option -&gt; MarkdownSpan<br /><br />--------------------<br />type LiteralAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; LiteralAttribute<br /><br />--------------------<br />new : unit -&gt; LiteralAttribute</div>
<div class="tip" id="fs33">System.Object.ToString() : string</div>
<div class="tip" id="fs34">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs35">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs36">union case MarkdownParagraph.ListBlock: kind: MarkdownListKind * items: MarkdownParagraphs list * range: MarkdownRange option -&gt; MarkdownParagraph</div>
<div class="tip" id="fs37">type MarkdownListKind =<br />&#160;&#160;| Ordered<br />&#160;&#160;| Unordered</div>
<div class="tip" id="fs38">union case MarkdownListKind.Ordered: MarkdownListKind</div>
<div class="tip" id="fs39">val listy : string</div>
<div class="tip" id="fs40">val docOl : LiterateDocument</div>

      </div>
      <div class="span3">
        <a href="https://fsprojects.github.io/FSharp.Formatting/index.html">
          <img src="https://fsprojects.github.io/FSharp.Formatting/misc/logo.png"
            style="width:140px;height:140px;margin:10px 0px 0px 35px;border-style:none;" />
        </a>

        <div id="header">
          <div class="searchbox">
            <label for="search-by">
              <i class="fas fa-search"></i>
            </label>
            <input data-search-input="" id="search-by" type="search" placeholder="Search..." />
            <span data-search-clear="">
              <i class="fas fa-times"></i>
            </span>
          </div>
        </div>
        <ul class="nav nav-list" id="menu">
          <li class="nav-header">FSharp.Formatting</li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting">Home page</a></li>
          <li class="divider"></li>
          <li><a href="https://github.com/fsprojects/FSharp.Formatting">Source Code on GitHub</a></li>
          <li><a href="https://github.com/fsprojects/FSharp.Formatting/blob/master/LICENSE.md">License (Apache 2.0)</a></li>
          <li><a href="https://github.com/fsprojects/FSharp.Formatting/blob/master/RELEASE_NOTES.md">Release Notes</a></li>

          <li class="nav-header">Using F# Formatting</li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/commandline.html">Using command line tool</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/literate.html">Literate programming</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/evaluation.html">Embedding output</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/markdown.html">Markdown parser</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/codeformat.html">F# code formatting</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/apidocs.html">Library documentation</a></li>

          <li class="nav-header">Examples</li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/sidescript.html">Literate F# script</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/sidemarkdown.html">Literate Markdown file</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/sideextensions.html">Markdown extensions</a></li>

          <li class="nav-header">Documentation</li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/reference/index.html">API Reference</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/development.html">Contribute / Development Topics</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/diagnostics.html">Diagnostics &amp; debugging</a></li>
          <li class="divider"></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/reference/fsharp-formatting-markdown-markdown.html">Markdown API</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/reference/fsharp-formatting-codeformat-codeformat.html">CodeFormat API</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/reference/fsharp-formatting-literate-literate.html">Literate API</a></li>
          <li><a href="https://fsprojects.github.io/FSharp.Formatting/reference/fsharp-formatting-apidocs-apidocs.html">ApiDocs API</a></li>
        </ul>
      </div>
    </div>
  </div>
  <a href="https://github.com/fsprojects/FSharp.Formatting"><img style="position: absolute; top: 0; right: 0; border: 0;"
      src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
  <script type="text/javascript">var baseurl = 'https://fsprojects.github.io/FSharp.Formatting'</script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.8/lunr.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.min.js"></script>
  <script type="text/javascript" src="https://fsprojects.github.io/FSharp.Formatting/content/search.js"></script>
</body>

</html>

