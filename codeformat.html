<!DOCTYPE html>
<html lang="en" data-root="https://fsprojects.github.io/FSharp.Formatting/">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Tomas Petricek; Oleg Pestov; Anh-Dung Phan; Xiang Zhang; Matthias Dittrich; Don Syme" name="author">
    <!-- Opengraph properties (https://ogp.me/) -->
    <meta property="og:site_name" content="FSharp.Formatting">
    <meta property="og:title" content="Code formatting
" />
    <meta property="og:url" content="https://fsprojects.github.io/FSharp.Formatting/codeformat.html">
    <meta property="og:type" content="website" />
    <!-- Twitter cards (https://developer.twitter.com/en/docs/twitter-for-websites/cards/overview/summary-card-with-large-image) -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="https://fsprojects.github.io/FSharp.Formatting/">
    <meta name="twitter:title" content="Code formatting
">
    
    <title>Code formatting
 | FSharp.Formatting</title>
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <link href="https://fsprojects.github.io/FSharp.Formatting/img/favicon.ico" rel="icon" sizes="32x32" type="image/png"/>
    <script type="application/javascript" src="https://fsprojects.github.io/FSharp.Formatting/content/fsdocs-theme-set-dark.js"></script>
    <script type="application/javascript" src="https://fsprojects.github.io/FSharp.Formatting/content/fsdocs-details-set-expanded.js"></script>
    <link href="https://fsprojects.github.io/FSharp.Formatting/content/fsdocs-default.css" rel="stylesheet" type="text/css"/>
    <link href="https://fsprojects.github.io/FSharp.Formatting/content/fsdocs-theme.css" rel="stylesheet" type="text/css"/>
    
    
</head>
<body class="content">
<header>
    <div class="start">
        <div id="menu-toggle">
            <iconify-icon class="icon closed" height="22" icon="eva:menu-fill" width="22"></iconify-icon>
            <iconify-icon class="icon open" height="22" icon="mi:close" width="22"></iconify-icon>
            <input type="checkbox" name="mobile-menu" />
            <ul class="menu">
                <li class="nav-header">Links</li>
                <li class="license-menu-item builtin-menu-item nav-item"><a class="nav-link" href="https://github.com/fsprojects/FSharp.Formatting/blob/master/LICENSE.md">License</a>
                </li>
                <li class="release-notes-menu-item builtin-menu-item nav-item"><a class="nav-link"
                                        href="https://github.com/fsprojects/FSharp.Formatting/blob/master/RELEASE_NOTES.md">Release
                    Notes</a></li>
                <li class="repository-menu-item builtin-menu-item nav-item"><a class="nav-link" href="https://github.com/fsprojects/FSharp.Formatting/">Source
                    Repository</a></li>
                <li class="nav-header ">
  Documentation
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/zero-to-hero.html">
    Getting Started
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/commandline.html">
    Command line

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/literate.html">
    Literate Scripts

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/literate-notebook.html">
    Literate Notebooks

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/content.html">
    Creating Content

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/apidocs.html">
    Generating API Docs
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/evaluation.html">
    Embedding script output

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/styling.html">
    Customization and Styling

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/users.html">
    Users of FSharp.Formatting

  </a>
</li>             
<li class="nav-header ">
  Examples
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/sidebyside/sidescript.html">
    Literate Script
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/sidebyside/sidemarkdown.html">
    Markdown Content
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/sidebyside/sideextensions.html">
    Markdown LaTeX
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/templates/leftside/styling.html">
    Example: Styling for Right-Side Navigation Bar

  </a>
</li>             
<li class="nav-header active">
  Advanced
</li>             
<li class="nav-item active">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/codeformat.html">
    Code formatting

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/upgrade.html">
    Upgrading to fsdocs

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/markdown.html">
    Markdown parser

  </a>
</li>
                <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/reference/index.html">
    All Namespaces
  </a>
</li>
            </ul>
        </div>
        <a href="https://fsprojects.github.io/FSharp.Formatting/">
            <img alt="Header menu logo" src="https://fsprojects.github.io/FSharp.Formatting/img/logo.png">
            <strong>FSharp.Formatting</strong>
        </a>
    </div>
    <div class="end">
        <a href="https://github.com/fsprojects/FSharp.Formatting/" target="_blank">
            <iconify-icon icon="uil:github" width="26" height="26"></iconify-icon>
        </a>
        <iconify-icon id="search-btn" icon="carbon:search" class="search" width="24" height="24"></iconify-icon>
        <fsdocs-theme-toggle></fsdocs-theme-toggle>
    </div>
</header>
<aside id="fsdocs-main-menu">
    <ul class="menu">
        <li class="nav-header">Links</li>
        <li class="license-menu-item builtin-menu-item nav-item"><a class="nav-link" href="https://github.com/fsprojects/FSharp.Formatting/blob/master/LICENSE.md">License</a>
        </li>
        <li class="release-notes-menu-item builtin-menu-item nav-item"><a class="nav-link"
                                href="https://github.com/fsprojects/FSharp.Formatting/blob/master/RELEASE_NOTES.md">Release
            Notes</a></li>
        <li class="repository-menu-item builtin-menu-item nav-item"><a class="nav-link" href="https://github.com/fsprojects/FSharp.Formatting/">Source
            Repository</a></li>
        <li class="nav-header ">
  Documentation
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/zero-to-hero.html">
    Getting Started
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/commandline.html">
    Command line

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/literate.html">
    Literate Scripts

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/literate-notebook.html">
    Literate Notebooks

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/content.html">
    Creating Content

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/apidocs.html">
    Generating API Docs
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/evaluation.html">
    Embedding script output

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/styling.html">
    Customization and Styling

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/users.html">
    Users of FSharp.Formatting

  </a>
</li>             
<li class="nav-header ">
  Examples
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/sidebyside/sidescript.html">
    Literate Script
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/sidebyside/sidemarkdown.html">
    Markdown Content
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/sidebyside/sideextensions.html">
    Markdown LaTeX
  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/templates/leftside/styling.html">
    Example: Styling for Right-Side Navigation Bar

  </a>
</li>             
<li class="nav-header active">
  Advanced
</li>             
<li class="nav-item active">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/codeformat.html">
    Code formatting

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/upgrade.html">
    Upgrading to fsdocs

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/markdown.html">
    Markdown parser

  </a>
</li>
        <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fsprojects.github.io/FSharp.Formatting/reference/index.html">
    All Namespaces
  </a>
</li>
    </ul>
</aside>
<main>
    <div id="content">
        
<p><a href="https://mybinder.org/v2/gh/fsprojects/fsharp.formatting/gh-pages?filepath=codeformat.ipynb"><img src="img/badge-binder.svg" alt="Binder" /></a>&emsp;
<a href="https://fsprojects.github.io/FSharp.Formatting//codeformat.fsx"><img src="img/badge-script.svg" alt="Script" /></a>&emsp;
<a href="https://fsprojects.github.io/FSharp.Formatting//codeformat.ipynb"><img src="img/badge-notebook.svg" alt="Notebook" /></a></p>
<h1><a name="Code-formatting" class="anchor" href="#Code-formatting">Code formatting</a></h1>
<p>This page demonstrates how to use <code>FSharp.Formatting.CodeFormat</code> to tokenize
F# source code, obtain information about the source code (mainly tooltips
from the type-checker) and how to turn the code into a nicely formatted HTML.</p>
<p>First, we need to load the assembly and open the necessary namespaces:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="id">Formatting</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="id">CodeFormat</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="id">System</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="id">Reflection</span>
</code></pre>
<p>If you want to process multiple snippets, it is a good idea to keep the
formatting agent around if possible. The agent needs to load the F# compiler
(which needs to load various files itself) and so this takes a long time.</p>
<h2><a name="Processing-F-source" class="anchor" href="#Processing-F-source">Processing F# source</a></h2>
<p>The formatting agent provides a <a href="https://fsharp.github.io/fsharp-core-docs/reference/fsharp-formatting-codeformat-codeformatagent#ParseAndCheckSource">CodeFormatAgent.ParseAndCheckSource</a> method (together with an asynchronous
version for use from F# and also a version that returns a .NET <code>Task</code> for C#).
To call the method, we define a simple F# code as a string:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="id">source</span> <span class="o">=</span>
    <span class="s">&quot;&quot;&quot;</span>
<span class="s">    let hello () =</span>
<span class="s">      printfn &quot;Hello world&quot;</span>
<span class="s">  &quot;&quot;&quot;</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="id">snippets</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="id">diagnostics</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs9', 9)" onmouseover="showTip(event, 'fs9', 9)" class="m">CodeFormatter</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs10', 10)" onmouseover="showTip(event, 'fs10', 10)" class="id">ParseAndCheckSource</span><span class="pn">(</span><span class="s">&quot;C:\\snippet.fsx&quot;</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs6', 11)" onmouseover="showTip(event, 'fs6', 11)" class="id">source</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs11', 12)" onmouseover="showTip(event, 'fs11', 12)" class="uc">None</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="uc">None</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs12', 14)" onmouseover="showTip(event, 'fs12', 14)" class="fn">ignore</span><span class="pn">)</span>
</code></pre>
<p>When calling the method, you need to specify a file name and the actual content
of the script file. The file does not have to physically exist. It is used by the
F# compiler to resolve relative references (e.g. <code>#r</code>) and to automatically name
the module including all code in the file.</p>
<p>You can also specify additional parameters, such as <code>*.dll</code> references, by passing
a third argument with compiler options (e.g. <code>"-r:Foo.dll -r:Bar.dll"</code>).</p>
<p>This operation might take some time, so it is a good idea to use an asynchronous
variant of the method. It returns two arrays - the first contains F# snippets
in the source code and the second contains any errors reported by the compiler.
A single source file can include multiple snippets using the same formatting tags
as those used on <a href="http://www.fssnip.net">fssnip.net</a> as documented in the
<a href="http://www.fssnip.net/pages/About">about page</a>.</p>
<h2><a name="Working-with-returned-tokens" class="anchor" href="#Working-with-returned-tokens">Working with returned tokens</a></h2>
<p>Each returned snippet is essentially just a collection of lines, and each line
consists of a sequence of tokens. The following snippet prints basic information
about the tokens of our sample snippet:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Get the first snippet and obtain list of lines</span>
<span class="k">let</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs13', 15)" onmouseover="showTip(event, 'fs13', 15)" class="uc">Snippet</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs14', 16)" onmouseover="showTip(event, 'fs14', 16)" class="id">title</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs15', 17)" onmouseover="showTip(event, 'fs15', 17)" class="id">lines</span><span class="pn">)</span><span class="pn">)</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 18)" onmouseover="showTip(event, 'fs7', 18)" class="id">snippets</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs16', 19)" onmouseover="showTip(event, 'fs16', 19)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs17', 20)" onmouseover="showTip(event, 'fs17', 20)" class="id">head</span>

<span class="c">// Iterate over all lines and all tokens on each line</span>
<span class="k">for</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs18', 21)" onmouseover="showTip(event, 'fs18', 21)" class="uc">Line</span> <span class="pn">(</span><span class="id">_</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs19', 22)" onmouseover="showTip(event, 'fs19', 22)" class="fn">tokens</span><span class="pn">)</span><span class="pn">)</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs15', 23)" onmouseover="showTip(event, 'fs15', 23)" class="id">lines</span> <span class="k">do</span>
    <span class="k">for</span> <span onmouseout="hideTip(event, 'fs20', 24)" onmouseover="showTip(event, 'fs20', 24)" class="fn">token</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs19', 25)" onmouseover="showTip(event, 'fs19', 25)" class="fn">tokens</span> <span class="k">do</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs20', 26)" onmouseover="showTip(event, 'fs20', 26)" class="fn">token</span> <span class="k">with</span>
        <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs21', 27)" onmouseover="showTip(event, 'fs21', 27)" class="rt">TokenSpan</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs22', 28)" onmouseover="showTip(event, 'fs22', 28)" class="id">Token</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs23', 29)" onmouseover="showTip(event, 'fs23', 29)" class="fn">kind</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs24', 30)" onmouseover="showTip(event, 'fs24', 30)" class="fn">code</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs25', 31)" onmouseover="showTip(event, 'fs25', 31)" class="fn">tip</span><span class="pn">)</span> <span class="k">-&gt;</span>
            <span onmouseout="hideTip(event, 'fs26', 32)" onmouseover="showTip(event, 'fs26', 32)" class="fn">printf</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs24', 33)" onmouseover="showTip(event, 'fs24', 33)" class="fn">code</span>

            <span onmouseout="hideTip(event, 'fs25', 34)" onmouseover="showTip(event, 'fs25', 34)" class="fn">tip</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs27', 35)" onmouseover="showTip(event, 'fs27', 35)" class="m">Option</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs28', 36)" onmouseover="showTip(event, 'fs28', 36)" class="id">iter</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs29', 37)" onmouseover="showTip(event, 'fs29', 37)" class="fn">spans</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs30', 38)" onmouseover="showTip(event, 'fs30', 38)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs29', 39)" onmouseover="showTip(event, 'fs29', 39)" class="fn">spans</span><span class="pn">)</span>
        <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs21', 40)" onmouseover="showTip(event, 'fs21', 40)" class="rt">TokenSpan</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs31', 41)" onmouseover="showTip(event, 'fs31', 41)" class="id">Omitted</span> <span class="id">_</span>
        <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs21', 42)" onmouseover="showTip(event, 'fs21', 42)" class="rt">TokenSpan</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs32', 43)" onmouseover="showTip(event, 'fs32', 43)" class="id">Output</span> <span class="id">_</span>
        <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs21', 44)" onmouseover="showTip(event, 'fs21', 44)" class="rt">TokenSpan</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs33', 45)" onmouseover="showTip(event, 'fs33', 45)" class="id">Error</span> <span class="id">_</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>

    <span onmouseout="hideTip(event, 'fs30', 46)" onmouseover="showTip(event, 'fs30', 46)" class="fn">printfn</span> <span class="s">&quot;&quot;</span>
</code></pre>
<p>The <code>TokenSpan.Token</code> is the most important kind of token. It consists of a kind
(identifier, keyword, etc.), the original F# code and tooltip information.
The tooltip is further formatted using a simple document format, but we simply
print the value using the F# pretty printing, so the result looks as follows:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span class="id">hello</span><span class="pn">[</span><span onmouseout="hideTip(event, 'fs34', 47)" onmouseover="showTip(event, 'fs34', 47)" class="id">Literal</span> <span class="s">&quot;val hello : unit -&gt; unit&quot;</span><span class="pn">;</span> <span class="o">..</span><span class="pn">.</span><span class="pn">]</span> <span class="pn">(</span><span class="pn">)</span> <span class="o">=</span>
  <span onmouseout="hideTip(event, 'fs30', 48)" onmouseover="showTip(event, 'fs30', 48)" class="id">printfn</span><span class="pn">[</span><span onmouseout="hideTip(event, 'fs34', 49)" onmouseover="showTip(event, 'fs34', 49)" class="id">Literal</span> <span class="s">&quot;val printfn : TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T&quot;</span><span class="pn">;</span> <span class="o">..</span><span class="pn">.</span><span class="pn">]</span> <span class="s">&quot;Hello world&quot;</span>
</code></pre>
<p>The <code>Omitted</code> token is generated if you use the special <code>(*[omit:...]*)</code> command.
The <code>Output</code> token is generated if you use the <code>// [fsi:...]</code> command to format
output returned by F# interactive. The <code>Error</code> command wraps code that should be
underlined with a red squiggle if the code contains an error.</p>
<h2><a name="Generating-HTML-output" class="anchor" href="#Generating-HTML-output">Generating HTML output</a></h2>
<p>Finally, the <code>CodeFormat</code> type also includes a method <a href="https://fsprojects.github.io/FSharp.Formatting/reference/fsharp-formatting-codeformat-codeformat.html#FormatHtml">CodeFormat.FormatHtml</a> that can be used
to generate nice HTML output from an F# snippet. This is used, for example, on
<a href="http://www.fssnip.net">F# Snippets</a>. The following example shows how to call it:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs35', 50)" onmouseover="showTip(event, 'fs35', 50)" class="id">prefix</span> <span class="o">=</span> <span class="s">&quot;fst&quot;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 51)" onmouseover="showTip(event, 'fs36', 51)" class="id">html</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs37', 52)" onmouseover="showTip(event, 'fs37', 52)" class="rt">CodeFormat</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 53)" onmouseover="showTip(event, 'fs38', 53)" class="id">FormatHtml</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs7', 54)" onmouseover="showTip(event, 'fs7', 54)" class="id">snippets</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs35', 55)" onmouseover="showTip(event, 'fs35', 55)" class="id">prefix</span><span class="pn">)</span>

<span class="c">// Print all snippets, in case there is more of them</span>
<span class="k">for</span> <span onmouseout="hideTip(event, 'fs39', 56)" onmouseover="showTip(event, 'fs39', 56)" class="fn">snip</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs36', 57)" onmouseover="showTip(event, 'fs36', 57)" class="id">html</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs40', 58)" onmouseover="showTip(event, 'fs40', 58)" class="id">Snippets</span> <span class="k">do</span>
    <span onmouseout="hideTip(event, 'fs30', 59)" onmouseover="showTip(event, 'fs30', 59)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs39', 60)" onmouseover="showTip(event, 'fs39', 60)" class="fn">snip</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 61)" onmouseover="showTip(event, 'fs41', 61)" class="id">Content</span>

<span class="c">// Print HTML code that is generated for ToolTips</span>
<span onmouseout="hideTip(event, 'fs30', 62)" onmouseover="showTip(event, 'fs30', 62)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs36', 63)" onmouseover="showTip(event, 'fs36', 63)" class="id">html</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs42', 64)" onmouseover="showTip(event, 'fs42', 64)" class="id">ToolTip</span>
</code></pre>
<p>If the input contains multiple snippets separated using the <code>//[snippet:...]</code> comment, e.g.:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip"><span class="c">// [snippet: First sample]</span>
<span class="i">printf</span> <span class="s">"The answer is: %A"</span> <span class="n">42</span>
<span class="c">// [/snippet]</span>
<span class="c">// [snippet: Second sample]</span>
<span class="i">printf</span> <span class="s">"Hello world!"</span>
<span class="c">// [/snippet]</span>
</pre>
</td>
</tr>
</table>
<p>then the formatter returns multiple HTML blocks. However, the generated tooltips
are shared by all snippets (to save space) and so they are returned separately.</p>

        <div class="fsdocs-tip" id="fs1">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="fsdocs-tip" id="fs2">namespace FSharp.Formatting</div>
<div class="fsdocs-tip" id="fs3">namespace FSharp.Formatting.CodeFormat</div>
<div class="fsdocs-tip" id="fs4">namespace System</div>
<div class="fsdocs-tip" id="fs5">namespace System.Reflection</div>
<div class="fsdocs-tip" id="fs6">val source: string</div>
<div class="fsdocs-tip" id="fs7">val snippets: Snippet array</div>
<div class="fsdocs-tip" id="fs8">val diagnostics: SourceError array</div>
<div class="fsdocs-tip" id="fs9">module CodeFormatter

from FSharp.Formatting.CodeFormat<br /><em>&lt;summary&gt;
 Uses agent to handle formatting requests
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs10">val ParseAndCheckSource: file: string * source: string * options: string option * defines: string option * onError: (string -&gt; unit) -&gt; Snippet array * SourceError array<br /><em>&lt;summary&gt;
 Parse, check and annotate the source code specified by &#39;source&#39;, assuming that it
 is located in a specified &#39;file&#39;. Optional arguments can be used
 to give compiler command line options and preprocessor definitions
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs11">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs12">val ignore: value: &#39;T -&gt; unit</div>
<div class="fsdocs-tip" id="fs13">Multiple items<br />union case Snippet.Snippet: title: string * lines: Line list -&gt; Snippet<br /><br />--------------------<br />type Snippet = | Snippet of title: string * lines: Line list<br /><em>&lt;summary&gt;
 An F# snippet consists of a snippet title and a list of lines
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs14">val title: string</div>
<div class="fsdocs-tip" id="fs15">val lines: Line list</div>
<div class="fsdocs-tip" id="fs16">module Seq

from Microsoft.FSharp.Collections</div>
<div class="fsdocs-tip" id="fs17">val head: source: &#39;T seq -&gt; &#39;T</div>
<div class="fsdocs-tip" id="fs18">Multiple items<br />union case Line.Line: originalLine: string * tokenSpans: TokenSpans -&gt; Line<br /><br />--------------------<br />type Line = | Line of originalLine: string * tokenSpans: TokenSpans<br /><em>&lt;summary&gt;
 Represents a line of source code as a list of TokenSpan values. This is
 a single case discriminated union with Line constructor.
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs19">val tokens: TokenSpans</div>
<div class="fsdocs-tip" id="fs20">val token: TokenSpan</div>
<div class="fsdocs-tip" id="fs21">type TokenSpan =
  | Token of kind: TokenKind * body: string * tip: ToolTipSpans option
  | Error of kind: ErrorKind * message: string * body: TokenSpans
  | Omitted of body: string * hidden: string
  | Output of string<br /><em>&lt;summary&gt;
 A token in a parsed F# code snippet. Aside from standard tokens reported from
 the compiler (Token), this also includes Error (wrapping the underlined
 tokens), Omitted for the special [omit:...] tags and Output for the special [output:...] tag
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs22">union case TokenSpan.Token: kind: TokenKind * body: string * tip: ToolTipSpans option -&gt; TokenSpan</div>
<div class="fsdocs-tip" id="fs23">val kind: TokenKind</div>
<div class="fsdocs-tip" id="fs24">val code: string</div>
<div class="fsdocs-tip" id="fs25">val tip: ToolTipSpans option</div>
<div class="fsdocs-tip" id="fs26">val printf: format: Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T</div>
<div class="fsdocs-tip" id="fs27">module Option

from Microsoft.FSharp.Core</div>
<div class="fsdocs-tip" id="fs28">val iter: action: (&#39;T -&gt; unit) -&gt; option: &#39;T option -&gt; unit</div>
<div class="fsdocs-tip" id="fs29">val spans: ToolTipSpans</div>
<div class="fsdocs-tip" id="fs30">val printfn: format: Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T</div>
<div class="fsdocs-tip" id="fs31">union case TokenSpan.Omitted: body: string * hidden: string -&gt; TokenSpan</div>
<div class="fsdocs-tip" id="fs32">union case TokenSpan.Output: string -&gt; TokenSpan</div>
<div class="fsdocs-tip" id="fs33">union case TokenSpan.Error: kind: ErrorKind * message: string * body: TokenSpans -&gt; TokenSpan</div>
<div class="fsdocs-tip" id="fs34">Multiple items<br />type LiteralAttribute =
  inherit Attribute
  new: unit -&gt; LiteralAttribute<br /><br />--------------------<br />new: unit -&gt; LiteralAttribute</div>
<div class="fsdocs-tip" id="fs35">val prefix: string</div>
<div class="fsdocs-tip" id="fs36">val html: FormattedContent</div>
<div class="fsdocs-tip" id="fs37">type CodeFormat =
  static member FormatFsx: snippets: Snippet seq -&gt; FormattedContent
  static member FormatHtml: snippets: Snippet array * prefix: string * ?openTag: string * ?closeTag: string * ?lineNumbers: bool * ?openLinesTag: string * ?closeLinesTag: string * ?addErrors: bool * ?tokenKindToCss: (TokenKind -&gt; string) -&gt; FormattedContent
  static member FormatLatex: snippets: Snippet array * ?openTag: string * ?closeTag: string * ?lineNumbers: bool -&gt; FormattedContent<br /><em>&lt;summary&gt;
 Exposes functionality of the F# code formatter with a nice interface
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs38">static member CodeFormat.FormatHtml: snippets: Snippet array * prefix: string * ?openTag: string * ?closeTag: string * ?lineNumbers: bool * ?openLinesTag: string * ?closeLinesTag: string * ?addErrors: bool * ?tokenKindToCss: (TokenKind -&gt; string) -&gt; FormattedContent</div>
<div class="fsdocs-tip" id="fs39">val snip: FormattedSnippet</div>
<div class="fsdocs-tip" id="fs40">property FormattedContent.Snippets: FormattedSnippet array with get<br /><em>&lt;summary&gt;
 Returns the processed snippets as an array
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs41">property FormattedSnippet.Content: string with get<br /><em>&lt;summary&gt;
 Returns the formatted content code for the snipet
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs42">property FormattedContent.ToolTip: string with get<br /><em>&lt;summary&gt;
 Returns string with ToolTip elements for all the snippets
&lt;/summary&gt;</em></div>

    </div>
</main>
<aside id="fsdocs-page-menu">
    <p id="on-this-page">On this page</p>
    <ul>
  <li class="level-1">
    <a href="#Code-formatting">
      Code formatting
    </a>
  </li>
  <li class="level-2">
    <a href="#Processing-F-source">
      Processing F# source
    </a>
  </li>
  <li class="level-2">
    <a href="#Working-with-returned-tokens">
      Working with returned tokens
    </a>
  </li>
  <li class="level-2">
    <a href="#Generating-HTML-output">
      Generating HTML output
    </a>
  </li>
</ul>
</aside>
<dialog>
    <input type="search" placeholder="Search docs" />
    <div class="results">
        <ul></ul>
        <p class="empty">Type something to start searching.</p>
    </div>
</dialog>
<script type="module" src="https://fsprojects.github.io/FSharp.Formatting/content/fsdocs-tips.js"></script>
<script type="module" src="https://fsprojects.github.io/FSharp.Formatting/content/fsdocs-theme-toggle.js"></script>
<script type="module" src="https://fsprojects.github.io/FSharp.Formatting/content/fsdocs-details-toggle.js"></script>
<script type="module" src="https://fsprojects.github.io/FSharp.Formatting/content/fsdocs-theme.js"></script>
<script type="module" src="https://fsprojects.github.io/FSharp.Formatting/content/fsdocs-search.js"></script>

</body>
</html>